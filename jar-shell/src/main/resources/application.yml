auth:
  uri: "http://your-auth0-endpoint/"
  audience: "auth0-audience"
  enabled: true
  web: false
marketdata:
  url: "http://localhost:9510"
  actuator: "http://localhost:9511"

org:
  jline:
    terminal:
      dumb: false
spring:
  main:
    banner-mode: "off"
    web-application-type: none
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${auth.uri}
  cloud:
    stream:
      bindings:
        # CSV Import Producer (StreamBridge)
        csvImport-out-0:
          destination: bc-trn-csv-dev
          content-type: application/json
      kafka:
        binder:
          brokers: kafka:9092

  jackson:
    serialization:
      INDENT_OUTPUT: true

  cache:
    cache-names: market

logging:
  level:
    root: error
    org: error
    com: error
    com.beancounter.shell.IngestBoot: error
    com.beancounter: info
    org.hibernate: error
    org.springframework.web.servlet: info
    sun: error
    jdk: error
    javax: error
    io: error
    io.github.resilience4j: fatal
  pattern:
    console: "%d - %m%n"

# Resilience4j configuration for jar-shell (CLI batch processing)
# Circuit breaker events: http://localhost:9500/actuator/circuitbreaker-events/marketdata
resilience4j:
  retry:
    configs:
      default:
        maxRetryAttempts: 10
        waitDuration: 1s
        ignoreExceptions:
          - com.beancounter.common.exception.BusinessException
          - io.github.resilience4j.circuitbreaker.CallNotPermittedException

  circuitbreaker:
    configs:
      default:
        failureRateThreshold: 3
        slidingWindowSize: 10
        permittedNumberOfCallsInHalfOpenState: 3
        slidingWindowType: TIME_BASED
        waitDurationInOpenState: 5s
        registerHealthIndicator: true
        recordFailurePredicate: com.beancounter.common.exception.RecordFailurePredicate
